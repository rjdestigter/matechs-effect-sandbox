(this["webpackJsonpmatechs-canvas"]=this["webpackJsonpmatechs-canvas"]||[]).push([[0],{142:function(n,e,t){n.exports=t(164)},143:function(n,e,t){},144:function(n,e,t){},148:function(n,e){},150:function(n,e){},164:function(n,e,t){"use strict";t.r(e);var r=t(8);t(143),t(144),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=t(6),a=t(40),i=t(2),u=t(0),o=t(9),s=t(7),f=t(5),p=t(1),l=t(3),b=t(11),d=function(n){return function(e){return e[n]}},O=function(n,e){return function(t){return t[n][e]}},j=d,m=(O("detail","value"),t(31)),h=function(n){return u.a.sync((function(){return n()}))},v=function(n){return Object(b.Do)(u.a.effect).bind("r",h(o.randomInt(0,255))).bind("g",h(o.randomInt(0,255))).bind("b",h(o.randomInt(0,255))).bind("a",null!=n?u.a.pure(n):h(Object(p.pipe)(o.randomInt(0,10),m.map((function(n){return n/10}))))).return((function(n){var e=n.r,t=n.g,r=n.b,c=n.a;return"rgba(".concat(e,", ").concat(t,", ").concat(r,", ").concat(c,")")}))};function y(n){return function(e){return function(n,e){var t=u.e.as({type:"until"})(u.e.encaseEffect(e)),r=Object(p.pipe)(n,u.e.map((function(n){return{type:"stream",value:n}})));return Object(p.pipe)(u.e.mergeAll([t,r]),u.e.takeWhile((function(n){return"stream"===n.type})),u.e.filter((function(n){return"stream"===n.type})),u.e.map((function(n){return n.value})))}(e,n)}}var g,k,S=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return e},w="@uri/canvas",E=function(n){return{type:"@instruction-group",instructions:n}},M=u.a.accessM((function(n){return n[w].clearRect()})),P=u.a.accessM((function(n){return n[w].canvas})),C=function(n){return function(e){return null!=e?u.a.pure(e):function(n){return Object(p.pipe)(P,u.a.map((function(e){return e[n]})))}(n)}},I=C("width"),R=C("height"),L=function(n){return function(e,t,r,c){return Object(b.Do)(u.a.effect).bind("width",I(r)).bind("height",R(c)).doL((function(r){var c=r.width,a=r.height;return u.a.sync((function(){return n.clearRect(e||0,t||0,c,a)}))})).return((function(n){var r=n.width,c=n.height;return{type:"@instruction/clearRect",args:S(e||0,t||0,r,c)}}))}},T=function(n){return u.a.accessM((function(e){var t=e[w];switch(n.type){case"@instruction-group":return Object(p.pipe)(W(n.instructions),u.a.map(E));case"@instruction/arc":return t.arc.apply(t,Object(c.a)(n.args));case"@instruction/lineTo":return t.lineTo.apply(t,Object(c.a)(n.args));case"@instruction/moveTo":return t.moveTo.apply(t,Object(c.a)(n.args));case"@instruction/save":return t.save;case"@instruction/restore":return t.restore;case"@instruction/beginPath":return t.beginPath;case"@instruction/closePath":return t.closePath;case"@instruction/clearRect":return t.clearRect.apply(t,Object(c.a)(n.args));case"@instruction/fill":return t.fill;case"@instruction/fillStyle":return t.fillStyle.apply(t,Object(c.a)(n.args));case"@instruction/lineWidth":return t.lineWidth.apply(t,Object(c.a)(n.args));case"@instruction/stroke":return t.stroke;case"@instruction/strokeStyle":return t.strokeStyle.apply(t,Object(c.a)(n.args))}}))},W=function(n){return Object(p.pipe)(n,s.map(T),s.array.sequence(u.a.effect))},q=function(n){var e=Object(i.a)(n,2),t=e[0],r=e[1];return u.a.accessM((function(n){return n[w].moveTo(t,r)}))},A=function(n){var e=Object(i.a)(n,2),t=e[0],r=e[1];return u.a.accessM((function(n){return n[w].lineTo(t,r)}))},G=function(n){return u.a.accessM((function(e){return e[w].lineWidth(n)}))},X=u.a.accessM((function(n){return n[w].beginPath})),B=u.a.accessM((function(n){return n[w].closePath})),D=u.a.accessM((function(n){return n[w].stroke})),x=function(n){return u.a.accessM((function(e){return n(e[w])}))},U=t(24),z=function(n,e){return function(t){return u.e.fromSource(u.c.managed.chain(u.c.bracket(u.a.accessM((function(r){return u.a.sync((function(){var c=u.e.su.queueUtils(),a=c.next,i=c.ops,o=c.hasCB;return{unsubscribe:(t?r["@uri/emitter"].addEventListener(t):r["@uri/emitter"].fromEvent)(n)((function(n){return a({_tag:"offer",a:n}),e})),ops:i,hasCB:o}}))})),j("unsubscribe")),(function(n){var e=n.ops,t=n.hasCB;return u.e.su.emitter(e,t)})))}},J=function(n){return function(e){return e.charCodeAt(n)}},N=t(4),V=t(41),Y=t(43),Z=t(44),$=u.a.accessM(Object(l.flow)((function(n){return n["@uri/document"]}),u.a.pure)),_=function(n){return function(e){return f.fromNullable(e.querySelector(n))}},F=function(n){return Object(p.pipe)($,u.a.map(_(n)))},H=function(n){return f.fromNullable(n.parentElement)},K=function(n){Object(V.a)(t,n);var e=Object(Y.a)(t);function t(n){var r;return Object(N.a)(this,t),(r=e.call(this,n)).name="EmptyOptionOfElement",r}return t}(Object(Z.a)(Error)),Q=function(n){return u.a.raiseError(new K(n))},nn=(g="click",function(n){return Object(p.pipe)(n,u.a.map((function(n){return Object(p.pipe)(n,f.map(z(g)),f.fold(Object(l.constant)(u.e.raised(new K("Option does not contain some element to create ".concat(g," event stream for")))),l.identity))})))}),en=function(n){var e=F(n),t=Object(p.pipe)(e,nn,u.e.encaseEffect,u.e.chain(l.identity)),r=function(n){return function(t){return Object(p.pipe)(e,u.a.chain((function(e){return Object(p.pipe)(e,f.fold(Object(l.constant)(Q(n)),(function(n){return u.a.sync((function(){return t(n)}))})))})))}},c=r("Unable to disable button(".concat(n,")"))((function(n){return n.setAttribute("disabled","true")})),a=r("Unable to enable button(".concat(n,")"))((function(n){return n.removeAttribute("disabled")}));return{element:e,clicks:t,disable:c,enable:a}},tn=en("#btn-add-polygon"),rn=(tn.element,tn.clicks),cn=tn.disable,an=tn.enable,un=en("#btn-add-circles"),on=(un.element,un.clicks),sn=un.disable,fn=un.enable,pn=en("#btn-add-markers"),ln=(pn.element,pn.clicks),bn=pn.disable,dn=pn.enable,On=en("#btn-save"),jn=(On.element,On.clicks),mn=On.disable,hn=On.enable,vn=en("#btn-cancel"),yn=(vn.element,vn.clicks),gn=vn.disable,kn=vn.enable,Sn=en("#btn-clear"),wn=(Sn.element,Sn.clicks),En=Sn.disable,Mn=Sn.enable,Pn=function(n){return S(n.offsetX,n.offsetY)},Cn=function(n){return Object(p.pipe)(u.a.accessM((function(n){return n[w].canvas})),u.e.encaseEffect,u.e.chain(z("click")),u.e.map(Pn),u.e.chain(Object(l.flow)(n,u.e.encaseEffect)))},In=Cn((function(n){var e=Object(i.a)(n,2),t=e[0],r=e[1];return Object(p.pipe)(o.randomInt(30,200),h,u.a.chain((function(n){return function(n,e,t,r,c){return u.a.accessM((function(a){var f=a[w];return Object(p.pipe)(u.a.zip(r?u.a.pure(r):h(o.randomInt(0,360)),c?u.a.pure(c):h(o.randomInt(Math.PI/10*1e3,1e3*Math.PI))),u.a.chain((function(r){var c=Object(i.a)(r,2),a=c[0],o=c[1],l=[Object(p.pipe)(v(1),u.a.chain(f.strokeStyle)),Object(p.pipe)(v(),u.a.chain(f.fillStyle)),f.lineWidth(2),f.beginPath,f.arc(n,e,t,a,o/1e3),f.stroke,f.fill];return s.array.sequence(u.a.effect)(l)})))}))}(t,r,n)})),u.a.map((function(n){return E(n)})))})),Rn=function(n){var e=Object(i.a)(n,2),t=e[0],r=e[1];return x((function(n){return Object(p.pipe)([n.beginPath,n.arc(t,r,3,0,2*Math.PI),n.strokeStyle("#000000"),n.fillStyle("#ffffff"),n.lineWidth(2),n.stroke,n.fill],s.array.sequence(u.a.effect),u.a.map(E))}))},Ln=Cn(Rn),Tn=function(n){return Object(p.pipe)(n,u.e.take(1),u.e.collectArray,u.a.map((function(n){return Object(i.a)(n,1)[0]})))},Wn=u.a.accessM((function(n){return n.restoreCanvas})),qn=Object(p.pipe)(u.d.makeRef({coords:[],instructionGroup:f.none}),u.e.encaseEffect,u.e.chain((function(n){return Object(p.pipe)(F("canvas"),u.a.chain((function(n){return Object(p.pipe)(n,f.fold(Object(l.constant)(Q("Canvas not available")),Object(l.flow)(z("click"),Tn)))})),u.a.map(Pn),u.a.chain((function(e){return n.set({coords:[e],instructionGroup:f.none})})),u.e.encaseEffect,u.e.chain(Object(l.constant)(Object(p.pipe)(Object(p.pipe)(F("canvas"),u.a.chain((function(n){return Object(p.pipe)(n,f.fold(Object(l.constant)(Q("Canvas not available")),(function(n){return u.a.race(Tn(z("click")(n)),Tn(z("mousemove")(n)))})))}))),u.a.chain((function(e){return Object(p.pipe)(e,Pn,(function(t){return"click"===e.type?Object(p.pipe)(n.update((function(n){var e=n.coords,r=n.instructionGroup;return{coords:[].concat(Object(c.a)(e),[t]),instructionGroup:r}})),u.a.map(j("coords"))):Object(p.pipe)(n.get,u.a.map((function(n){var e=n.coords;return[].concat(Object(c.a)(e),[t])})))}),u.a.map((function(n){return S(e.type,n)})))})),u.a.chain((function(e){var t=Object(i.a)(e,2),r=t[0],o=t[1];return Object(b.Do)(u.a.effect).do(M).do(Wn).bind("polygonInstructions",function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v();return function(e){var t=Object(a.a)(e),r=t[0],i=t.slice(1);return Object(p.pipe)(n,u.a.chain((function(n){return s.array.sequence(u.a.effect)(Object(p.pipe)([X,G(1),x((function(n){return n.strokeStyle("#000")})),x((function(e){return e.fillStyle(n)})),q(r)].concat(Object(c.a)(i.map(A)),[B,D,x((function(n){return n.fill})),Rn(r)],Object(c.a)(i.map(Rn)))))})),u.a.map(E))}}("click"===r?v():u.a.pure("#ccc"))(o)).doL((function(e){var t=e.polygonInstructions;return"click"===r&&o.length>2?n.update((function(n){var e=n.coords;n.instructionGroup;return{coords:e,instructionGroup:f.some(t)}})):u.a.pure(1)})).done()})),u.e.encaseEffect,u.e.chain(Object(l.constant)(Object(p.pipe)(n.get,u.a.map(j("instructionGroup")),u.e.encaseEffect))),u.e.repeat))))}))),An=function(n){return Object(p.pipe)(z("keyup")(),u.e.map(j("keyCode")),u.e.filter(n.includes.bind(n)),u.e.take(1),u.e.collectArray,u.a.map((function(n){return Object(i.a)(n,1)[0]})),u.a.map(String.fromCharCode))},Gn=Object(p.pipe)(Tn(rn),u.a.map((function(n){return"3"}))),Xn=Object(p.pipe)(Tn(on),u.a.map((function(n){return"1"}))),Bn=Object(p.pipe)(Tn(ln),u.a.map((function(n){return"2"}))),Dn=Object(p.pipe)(Tn(jn),u.a.map((function(n){return"S"}))),xn=Object(p.pipe)(Tn(yn),u.a.map((function(n){return"X"}))),Un=Object(p.pipe)(Tn(wn),u.a.map((function(n){return"X"}))),zn=Object(p.pipe)(u.a.race(Object(p.pipe)(["1","2","3","R","X"],s.map(J(0)),An),u.a.race(u.a.race(Gn,Xn),u.a.race(Bn,Un))),u.a.chain((function(n){return u.a.as(s.array.sequence(u.a.effect)("X"!==n?[bn,cn,sn,hn,kn]:[]),n)}))),Jn=Object(p.pipe)(["S","X"],s.map(J(0)),An,(function(n){return u.a.race(n,u.a.race(Dn,xn))}),u.a.chain((function(n){return u.a.as(s.array.sequence(u.a.effect)([dn,an,fn,mn,gn]),n)}))),Nn=function(n){return Object(p.pipe)(u.a.parZip(Object(p.pipe)(n,y(Jn),u.e.collectArray),Jn),u.a.map((function(n){var e=Object(i.a)(n,2),t=e[0];return"S"===e[1]?f.some(t):f.none})))},Vn=Nn(In),Yn=Object(b.Do)(u.a.effect).bind("stateRef",Object(p.pipe)(s.array.sequence(u.a.effect)([mn,gn,En]),u.a.chain(Object(l.constant)(u.d.makeRef({instructions:[]}))))).bindL("restoreCanvas",(function(n){var e=n.stateRef;return u.a.sync((function(){return Object(p.pipe)(e.get,u.a.chain((function(n){return Object(p.pipe)(n,j("instructions"),s.map(T),s.array.sequence(u.a.effect))})),u.a.map(l.constVoid))}))})).doL((function(n){var e=n.stateRef,t=n.restoreCanvas;return u.a.forever(Object(b.Do)(u.a.effect).do(M).do(Object(p.pipe)(e.get,u.a.map(Object(l.flow)(j("instructions"),j("length"),Boolean)),u.a.chain((function(n){return n?Mn:En})))).do(Object(p.pipe)(e.get,u.a.chain((function(n){return W(n.instructions)})))).bind("mainMenuChoice",zn).bindL("additionalInstructions",(function(n){switch(n.mainMenuChoice){case"1":return Vn;case"2":return Nn(Ln);case"3":return Object(p.pipe)(Nn(Object(p.pipe)(e.get,u.a.map(j("instructions")),u.e.encaseEffect,u.e.chain(Object(l.constant)(qn)))),u.a.map((function(n){return Object(p.pipe)(n,f.chain((function(n){return Object(p.pipe)(n,s.reverse,(function(n){return Object(i.a)(n,1)[0]}))})),f.map(s.of))})),u.a.provideS({restoreCanvas:t}));case"X":return u.a.as(e.update((function(){return{instructions:[]}})),f.none);default:return u.a.pure(f.none)}})).doL((function(n){var t=n.additionalInstructions;return Object(p.pipe)(t,f.map((function(n){return u.a.as(e.update((function(e){return{instructions:[].concat(Object(c.a)(e.instructions),Object(c.a)(n))}})),1)})),f.fold(Object(l.constant)(u.a.pure(1)),l.identity))})).done())})).done(),Zn=t(42),$n=Object(l.flow)(l.constVoid,u.a.pure),_n=(k=function(n){return Object(p.pipe)(F("canvas"),u.a.chain((function(e){return Object(p.pipe)(e,f.fold($n,(function(e){return Object(p.pipe)(e,H,f.fold($n,(function(t){return Object(p.pipe)(u.a.zip(Object(p.pipe)(u.a.sync((function(){var n=t.getBoundingClientRect(),r=n.width,c=n.height;return e.width=r,e.height=c,e.onmousedown=Object(l.constant)(!1),e})),u.a.chain((function(n){return Yn})),u.a.provideS((a=n,Object(r.a)({},"@uri/emitter",{fromEvent:function(n){return function(e){return a.addEventListener(n,(function(n){return n.stopPropagation(),e(n)})),u.a.sync((function(){return a.removeEventListener(n,e)}))}},addEventListener:function(n){return function(e){return function(t){return n.addEventListener(e,(function(n){return n.stopPropagation(),t(n)})),u.a.sync((function(){return n.removeEventListener(e,t)}))}}}}))),u.a.provideS((c=e.getContext("2d"),Object(r.a)({},w,{canvas:u.a.pure(c.canvas),arc:function(n,e,t,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return u.a.as(u.a.sync((function(){return c.arc(n,e,t,r,a,i)})),{type:"@instruction/arc",args:[n,e,t,r,a,i]})},lineTo:function(n,e){return u.a.as(u.a.sync((function(){return c.lineTo(n,e)})),{type:"@instruction/lineTo",args:[n,e]})},moveTo:function(n,e){return u.a.as(u.a.sync((function(){return c.moveTo(n,e)})),{type:"@instruction/moveTo",args:[n,e]})},clearRect:L(c),beginPath:u.a.as(u.a.sync((function(){return c.beginPath()})),{type:"@instruction/beginPath"}),closePath:u.a.as(u.a.sync((function(){return c.closePath()})),{type:"@instruction/closePath"}),stroke:u.a.as(u.a.sync((function(){return c.stroke()})),{type:"@instruction/stroke"}),save:u.a.as(u.a.sync((function(){return c.save()})),{type:"@instruction/save"}),restore:u.a.as(u.a.sync((function(){return c.restore()})),{type:"@instruction/restore"}),fill:u.a.as(u.a.sync((function(){return c.fill()})),{type:"@instruction/fill"}),lineWidth:function(n){return u.a.as(u.a.sync((function(){c.lineWidth=Math.abs(n)})),{type:"@instruction/lineWidth",args:[n]})},strokeStyle:function(n){return u.a.as(u.a.sync((function(){c.strokeStyle=n})),{type:"@instruction/strokeStyle",args:[n]})},fillStyle:function(n){return u.a.as(u.a.sync((function(){c.fillStyle=n})),{type:"@instruction/fillStyle",args:[n]})}})))),$n()),u.a.map(Zn.snd));var c,a})))})))})))},Object(p.pipe)($,u.a.map(k)));Object(p.pipe)(Object(p.pipe)(_n,u.a.chain(l.identity)),u.a.provideS(Object(r.a)({},"@uri/document",document)),U.b,u.a.run),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(n){n.unregister()})).catch((function(n){console.error(n.message)}))}},[[142,1,2]]]);
//# sourceMappingURL=main.f9949e6d.chunk.js.map